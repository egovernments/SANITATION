<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link
      rel="icon"
      href="https://cdn.jsdelivr.net/npm/@egovernments/digit-ui-css/img/browser-icon.png"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
      type="text/css"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#00bcd1" />
    <title>Sanitation</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/@egovernments/digit-ui-css@1.8.0-beta.14/dist/index.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/@egovernments/digit-ui-fsm-css@0.1.29/dist/index.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/@egovernments/digit-ui-components-css@0.0.2-beta.38/dist/index.css"
    />

    <!-- <link rel="stylesheet" href="https://unpkg.com/@egovernments/digit-ui-css/dist/index.css"/> -->
    <script src="https://egov-dev-assets.s3.ap-south-1.amazonaws.com/globalConfigsFSMpg.js"></script>
    <script src="%REACT_APP_GLOBAL%"></script>
    <style>
      .app-container form .card .input-otp-wrap {
        background-color: #ffff !important;
      }
      .fsm-citizen-wrapper {
        margin-top: 3rem;
      }
      .citizen-all-services-wrapper {
        margin-top: 3rem;
      }
      .SideBarStatic {
        margin-top: 2rem;
      }
      .action-bar-wrap {
        display: flex;
        align-items: center;
        justify-content: flex-end;
      }
      .action-bar-wrap .card-link {
        position: absolute;
        left: 2em;
        margin-top: 4px;
        max-width: 20em;
      }
    </style>
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
  <script>
    (function () {
      function updateBreadcrumbLinks() {
        const currentPath = window.location.pathname;
        if (currentPath.includes("/employee/dss/dashboard/fsm") || currentPath.includes("/employee/dss/dashboard/pqm")) {
          const breadcrumb = document.querySelector(
            '[class*="bread-crumb"], ol.breadcrumb, nav.breadcrumb, ul.breadcrumb'
          );
          if (breadcrumb) {
            const links = breadcrumb.querySelectorAll("a");
            if (links.length === 0) return false;
  
            let updated = false;
            links.forEach((link) => {
              if (link.href.includes("/landing")) {
                const linkItem = link.closest("li") || link;
                linkItem.remove();
                updated = true;
              } else {
                if (!link.dataset.modified) {
                  link.removeAttribute("href");
                  link.style.cursor = "pointer";
                  link.title = "Go back";
  
                  link.addEventListener("click", function (event) {
                    event.preventDefault();
  
                    const expectedPath = "/sanitation-ui/employee";
                    const expectedUrl = window.location.origin + expectedPath;
                    const storedReferrer = sessionStorage.getItem("lastVisitedPage");
  
                    const shouldGoBack = storedReferrer === expectedUrl;
  
                    if (shouldGoBack) {
                      history.back();
                    } else {
                      window.location.href = expectedUrl;
                    }
                  });
  
                  link.dataset.modified = "true";
                }
                updated = true;
              }
            });
  
            return updated;
          }
        }
        return false;
      }
  
      function startObserver() {
        const observer = new MutationObserver(() => {
          updateBreadcrumbLinks();
        });
  
        observer.observe(document.body, {
          childList: true,
          subtree: true,
        });
  
        setTimeout(() => observer.disconnect(), 10000);
      }
  
      function handlePageLoad() {
        if (!updateBreadcrumbLinks()) {
          startObserver();
        }
      }
  
      // Track navigation for SPAs and normal loads
      function trackPageVisit() {
        sessionStorage.setItem("lastVisitedPage", window.location.href);
      }
  
      // Trigger on initial load
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", () => {
          trackPageVisit();
          handlePageLoad();
        });
      } else {
        trackPageVisit();
        handlePageLoad();
      }
  
      // Track on navigation events
      window.addEventListener("popstate", () => {
        trackPageVisit();
        handlePageLoad();
      });
      window.addEventListener("hashchange", () => {
        trackPageVisit();
        handlePageLoad();
      });
  
      // Patch pushState and replaceState for SPA navigation tracking
      (function (history) {
        const origPush = history.pushState;
        const origReplace = history.replaceState;
  
        history.pushState = function () {
          trackPageVisit();
          origPush.apply(this, arguments);
          handlePageLoad();
        };
  
        history.replaceState = function () {
          trackPageVisit();
          origReplace.apply(this, arguments);
          handlePageLoad();
        };
      })(window.history);
    })();
  </script>
  
  
  
</html>
